PROJECT(Castor)
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

FILE(GLOB SEED_PNG ../data/seed/*.png)

ADD_EXECUTABLE(castor
  FaceDetector.cpp
  doImport.cpp
  doPca.cpp
  doProject.cpp
  castor.cpp)
ADD_EXECUTABLE(sean MACOSX_BUNDLE
  ../data/projection/projection.yml
  ${SEED_PNG}
  sean.cpp)
SET_PROPERTY(
  TARGET sean
  PROPERTY OSX_ARCHITECTURES i386)

SET(CMAKE_MODULE_PATH
  "${CMAKE_SOURCE_DIR}/cmake;${CMAKE_MODULE_PATH}")
INCLUDE(ConfigMacros)

FIND_PACKAGE(OpenCV REQUIRED)
INCLUDE_DIRECTORIES(${OpenCV_INCLUDE_DIR})
TARGET_LINK_LIBRARIES(castor ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(sean ${OpenCV_LIBS})

FIND_PACKAGE(Boost
  COMPONENTS system filesystem
  REQUIRED)
TARGET_LINK_LIBRARIES(castor ${Boost_LIBRARIES})
TARGET_LINK_LIBRARIES(sean ${Boost_LIBRARIES})

REQUIRE_HEADER(gflags_INCLUDE gflags/gflags.h)
FIND_AND_LINK_LIBRARY(gflags castor)

# this list is taken from an xcode project generated by tinder
FIND_AND_LINK_LIBRARY(Accelerate sean)
FIND_AND_LINK_LIBRARY(AudioToolbox sean)
FIND_AND_LINK_LIBRARY(AudioUnit sean)
FIND_AND_LINK_LIBRARY(CoreAudio sean)
FIND_AND_LINK_LIBRARY(QuickTime sean)
FIND_AND_LINK_LIBRARY(QTKit sean)
FIND_AND_LINK_LIBRARY(CoreVideo sean)
FIND_AND_LINK_LIBRARY(Carbon sean)
FIND_AND_LINK_LIBRARY(OpenGL sean)
FIND_AND_LINK_LIBRARY(Cocoa sean)
FIND_AND_LINK_LIBRARY(AppKit sean)
FIND_AND_LINK_LIBRARY(CoreData sean)
FIND_AND_LINK_LIBRARY(Foundation sean)

# cinder needs some help (PATHS)
FIND_LIBRARY(cinder_LIBRARY cinder PATHS ${CINDER_ROOT}/lib)
FIND_AND_LINK_LIBRARY(cinder sean)
FIND_PATH(cinder_INCLUDE cinder/app/AppBasic.h PATHS ${CINDER_ROOT}/include)
REQUIRE_HEADER(cinder_INCLUDE cinder/app/AppBasic.h)

# copy mac resources...
SET_SOURCE_FILES_PROPERTIES(
  ../data/projection/projection.yml
  PROPERTIES
  MACOSX_PACKAGE_LOCATION Resources)

SET_SOURCE_FILES_PROPERTIES(
  ${SEED_PNG}
  PROPERTIES
  MACOSX_PACKAGE_LOCATION Resources/seed)

